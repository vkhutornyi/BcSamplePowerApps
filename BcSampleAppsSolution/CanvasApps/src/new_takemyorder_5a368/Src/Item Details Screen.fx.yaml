"'Item Details Screen' As screen":
    LoadingSpinnerColor: =RGBA(100, 118, 132, 1)
    OnVisible: |-
        =UpdateContext({ctxItemDetailsImage: Blank()});
        UpdateContext({ctxItemDetailsImage: LookUp('itemsWithImage (microsoft/powerApps/beta)', id = ctxSelectedItem.id).picture});

    conItemDetailsTop As groupContainer.manualLayoutContainer:
        Height: =120
        Width: =Parent.Width
        ZIndex: =1

        comBigDivider_1 As comBigDivider:
            Height: =16  
            Y: =Parent.Height - Self.Height

        lblItemDetailsHeader As label:
            Align: =Align.Center
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =varTheme.primaryColor
            DisabledColor: =RGBA(166, 166, 166, 1)
            Height: =65
            OnSelect: =
            Size: =30
            Text: ="Item Details"
            Width: =Parent.Width
            Y: =25
            ZIndex: =2

        icnCloseItemDetails As icon.Lock:
            BorderColor: =RGBA(32, 54, 71, 1)
            Color: =varTheme.primaryColor
            DisabledBorderColor: =RGBA(166, 166, 166, 1)
            DisabledColor: =RGBA(244, 244, 244, 1)
            Height: =40
            Icon: =Icon.Cancel
            OnSelect: |-
                =UpdateContext({ctxShowItemQuantityControl: false});
                Back(ScreenTransition.UnCoverRight);
            Width: =40
            X: =Parent.Width - Self.Width - 25  
            Y: =40
            ZIndex: =3

    conItemDetails As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height - conItemDetailsTop.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =Parent.Width
        Y: =conItemDetailsTop.Height
        ZIndex: =3

        conItemMainInfo As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =120
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =1

            Label1 As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Height: =70
                Size: =21
                Text: =ctxSelectedItem.displayName
                Width: =465
                X: =40
                Y: =16
                ZIndex: =1

            Label3 As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Height: =70
                Size: =21
                Text: =Text(ctxSelectedItem.unitPrice, varCurrencyFormat)
                Width: =177
                X: =40
                Y: =60
                ZIndex: =2

            icnAddItem_2 As icon.ChevronRight:
                AccessibleLabel: =Self.Tooltip
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =varTheme.primaryColor
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(244, 244, 244, 1)
                Height: =varTheme.iconSizeSmall
                Icon: =Icon.Add
                OnSelect: |-
                    =// Clear quantity control if it is showing
                    UpdateContext({ctxShowItemQuantityControl: Blank()});
                    // Check if item is in list
                    UpdateContext({ ctxIsItemInList: IsBlank(LookUp(colSelectedItems, id = ctxSelectedItem.id))});
                    
                    If(
                        ctxIsItemInList,
                        // Add item to list
                        Collect(
                            colSelectedItems,
                            {
                                id: ctxSelectedItem.id,
                                name: ctxSelectedItem.displayName,
                                price: ctxSelectedItem.unitPrice,
                                group: ctxSelectedItem.'Item Category Name',
                                quantity: 1,
                                // Use placeholder image if the image is not provided
                                image: If(
                                    ctxSelectedItem.itemImageText = GUID("00000000-0000-0000-0000-000000000000"),
                                    placeholder,
                                    ctxSelectedItem.picture
                                )
                            }
                        );
                        ,
                        // Update item quantity
                        Patch(
                            colSelectedItems,
                            {id: ctxSelectedItem.id},
                            {quantity: Value(btnQCQuantity_2.Text) + 1}
                        )
                    );
                TabIndex: =0
                Tooltip: ="View item details"
                Width: =varTheme.iconSizeSmall
                X: =Parent.Width - (icnAddItem_2.Width/2) - 50
                Y: =Parent.Height/2 - Self.Height/2
                ZIndex: =3

            btnQuantity_1 As button:
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Fill: =varTheme.primaryColor
                FontWeight: =FontWeight.Semibold
                Height: =varTheme.iconSizeBig
                HoverColor: =RGBA(255, 255, 255, 1)
                HoverFill: =varTheme.primaryColor
                OnSelect: |-
                    =UpdateContext({ctxShowItemQuantityControl: true})
                RadiusBottomLeft: =35
                RadiusBottomRight: =35
                RadiusTopLeft: =35
                RadiusTopRight: =35
                Size: =24
                Text: =LookUp(colSelectedItems, id = ctxSelectedItem.id).quantity
                Visible: |-
                    =// Does quantity have a value
                    And(
                        Not(btnQuantity_1.Text = "0"),
                        Not(IsBlank(btnQuantity_1.Text))
                    )
                        
                Width: =varTheme.iconSizeBig
                X: =Parent.Width - (btnQuantity_1.Width/2) - 50
                Y: =Parent.Height/2 - Self.Height/2
                ZIndex: =4

            recItemQuantityOverlayTop As rectangle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =Color.Transparent
                Height: =Parent.Height
                OnSelect: |-
                    =UpdateContext({ctxShowItemQuantityControl: false});
                Visible: =ctxShowItemQuantityControl
                Width: =Parent.Width
                X: =
                ZIndex: =5

            conQuantityControl_2 As groupContainer.manualLayoutContainer:
                Height: =70
                Visible: |
                    =ctxShowItemQuantityControl 
                Width: =275
                X: =Parent.Width - 280
                Y: =Parent.Height/2 - Self.Height/2
                ZIndex: =6

                btnQCBackground_2 As button:
                    BorderColor: =Color.White
                    BorderThickness: =1
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =varTheme.primaryColor
                    DisplayMode: =DisplayMode.View
                    Fill: =varTheme.primaryColor
                    FontWeight: =FontWeight.Semibold
                    Height: =70
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =varTheme.primaryColor
                    OnSelect: =
                    PressedFill: =varTheme.primaryColor
                    RadiusBottomLeft: =35
                    RadiusBottomRight: =35
                    RadiusTopLeft: =35
                    RadiusTopRight: =35
                    Size: =24
                    Text: =
                    Width: =250
                    X: =15
                    ZIndex: =1

                btnQCAddItemBack_2 As button:
                    BorderColor: =Color.White
                    BorderThickness: =1
                    DisabledBorderColor: =RGBA(255, 255, 255, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =DisplayMode.View
                    Fill: =Color.White
                    FontWeight: =FontWeight.Semibold
                    Height: =60
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(100, 118, 132, 1), -20%)
                    OnSelect: =
                    RadiusBottomLeft: =35
                    RadiusBottomRight: =35
                    RadiusTopLeft: =35
                    RadiusTopRight: =35
                    Size: =24
                    Text: =
                    Width: =60
                    X: =200
                    Y: =5
                    ZIndex: =2

                icnQCAddItem_2 As icon.ChevronRight:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(32, 54, 71, 1)
                    Color: =varTheme.primaryColor
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(244, 244, 244, 1)
                    Height: =50
                    Icon: =Icon.Add
                    OnSelect: |-
                        =Patch(
                            colSelectedItems,
                            {id: ctxSelectedItem.id},
                            {quantity: Value(btnQCQuantity_2.Text) + 1}
                        )
                    TabIndex: =0
                    Tooltip: ="View item details"
                    Width: =50
                    X: =205
                    Y: =11
                    ZIndex: =3

                btnQCQuantity_2 As button:
                    BorderColor: =Color.White
                    BorderThickness: =1
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    Fill: =varTheme.primaryColor
                    FontWeight: =FontWeight.Semibold
                    Height: =60
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(100, 118, 132, 1), -20%)
                    OnSelect: =
                    RadiusBottomLeft: =35
                    RadiusBottomRight: =35
                    RadiusTopLeft: =35
                    RadiusTopRight: =35
                    Size: =24
                    Text: =LookUp(colSelectedItems, id = ctxSelectedItem.id).quantity
                    Width: =60
                    X: =115
                    Y: =5
                    ZIndex: =4

                btnQCRemoveItemBack_2 As button:
                    BorderColor: =Color.White
                    BorderThickness: =1
                    DisabledBorderColor: =RGBA(255, 255, 255, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisabledFill: =RGBA(244, 244, 244, 1)
                    DisplayMode: =DisplayMode.View
                    Fill: =Color.White
                    FontWeight: =FontWeight.Semibold
                    Height: =60
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =ColorFade(RGBA(100, 118, 132, 1), -20%)
                    OnSelect: =
                    RadiusBottomLeft: =35
                    RadiusBottomRight: =35
                    RadiusTopLeft: =35
                    RadiusTopRight: =35
                    Size: =24
                    Text: =
                    Width: =60
                    X: =20
                    Y: =5
                    ZIndex: =5

                icnQCRemoveItem_2 As icon.ChevronRight:
                    AccessibleLabel: =Self.Tooltip
                    BorderColor: =RGBA(32, 54, 71, 1)
                    Color: =varTheme.primaryColor
                    DisabledBorderColor: =RGBA(166, 166, 166, 1)
                    DisabledColor: =RGBA(244, 244, 244, 1)
                    Height: =50
                    Icon: =Icon.HorizontalLine
                    OnSelect: |-
                        =If(
                            Value(btnQCQuantity_2.Text) > 0,
                            Patch(
                                colSelectedItems,
                                {id: ctxSelectedItem.id},
                                {quantity: Value(btnQCQuantity_2.Text) - 1}
                            )
                        )
                    PaddingLeft: =5
                    PaddingRight: =5
                    TabIndex: =0
                    Tooltip: ="View item details"
                    Width: =50
                    X: =25
                    Y: =11
                    ZIndex: =6

        conItemImage As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =400
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =2

            htmlItemDetailsImageShadow As htmlViewer:
                Height: =345
                HtmlText: |+
                    ="<div style='
                    height: " & Self.Height -25 & "px;   
                    width: " & Self.Width - 25 & "px;   
                    box-shadow: 1px 1px 1px 1px gray;
                    margin: 10px;
                    '></div>
                    "
                    
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Tooltip: =
                Width: =345
                X: =30
                Y: =30
                ZIndex: =1

            imgItemDetailsImage As image:
                BorderColor: =RGBA(32, 54, 71, 1)
                DisabledBorderColor: =RGBA(166, 166, 166, 1)
                DisabledFill: =RGBA(244, 244, 244, 1)
                Height: =320
                Image: =ctxItemDetailsImage
                Width: =320
                X: =40
                Y: =40
                ZIndex: =2

            recImageOverlay As rectangle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =RGBA(255, 188, 0, 0.08)
                Height: =imgItemDetailsImage.Height
                Visible: =false
                Width: =imgItemDetailsImage.Width
                X: =imgItemDetailsImage.X
                Y: =imgItemDetailsImage.Y
                ZIndex: =3

            recItemQuantityOverlayMiddel As rectangle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =Color.Transparent
                Height: =Parent.Height
                OnSelect: |-
                    =UpdateContext({ctxShowItemQuantityControl: false});
                Visible: =ctxShowItemQuantityControl
                Width: =Parent.Width
                X: =
                ZIndex: =4

        conItemExtraInfo As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =400
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =3

            Label4 As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Height: =70
                Size: =21
                Text: =LookUp('itemsWithImage (microsoft/powerApps/beta)', id = ctxSelectedItem.id).GTIN
                Width: =560
                X: =15
                Y: =65
                ZIndex: =1

            recItemQuantityOverlayExtraInfo As rectangle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =Color.Transparent
                Height: =Parent.Height
                OnSelect: |-
                    =UpdateContext({ctxShowItemQuantityControl: false});
                Visible: =ctxShowItemQuantityControl
                Width: =Parent.Width
                X: =
                ZIndex: =2

        conItemAddNote As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =100
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =5

